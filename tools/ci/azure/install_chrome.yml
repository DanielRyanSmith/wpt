steps:
# The conflicting google-chrome and chromedriver casks are first uninstalled.
# The raw google-chrome-dev cask URL is used to bypass caching.
- script: |
    set -eux -o pipefail

  # wget unzip chrome jq
  # CHROME_DOWNLOAD_URL=$$(curl -s https://googlechromelabs.github.io/chrome-for-testing/last-known-good-versions-with-downloads.json | jq -r ".channels.Canary.downloads.chrome[] | select(.platform == \"linux64\") | .url"); \
  # TEMP_DIR=$$(mktemp -d); \
  # wget -q -O $${TEMP_DIR}/chrome-linux64.zip $${CHROME_DOWNLOAD_URL}; \
  # unzip -j $${TEMP_DIR}/chrome-linux64.zip -d $${TEMP_DIR}; \
  # sudo mv $${TEMP_DIR}/chrome .; \
  ./wpt install --channel experimental chrome browser
  displayName: 'Install Chrome Canary'
  condition: and(succeeded(), eq(variables['Agent.OS'], 'Darwin'))
